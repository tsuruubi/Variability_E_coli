for(j in length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
if(length(temp3.1)>0){
print(paste(unique(temp3.1),collapse=","))
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
for(j in length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
if(length(temp3.1)>0){
print(paste(unique(temp3.1),collapse=","))
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
j<-1
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
if(length(temp3.1)>0){
print(paste(unique(temp3.1),collapse=","))
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
j<-1
for(j in length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
if(length(temp3.1)>0){
print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
j<-1
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
temp3.1
length(temp3.1)
print(j)
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
if(length(temp3.1)>0){
print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
j<-1
for(j in length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
print(temp3.1)
if(length(temp3.1)>0){
print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
temp<-dprobes[dprobes$Name %in% multihits,]
rownames(temp)<-seq(1,nrow(temp))
temp$ECKnb<-NA
temp$JWnb<-NA
temp$Bnb<-NA
i<-209
for(i in 1:nrow(temp)){
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
j<-1
for(j in 1:length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
print(temp3.1)
if(length(temp3.1)>0){
print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
if(length(temp4.1)>0){
temp$ECKnb[i]<-paste(unlist(temp4.1),sep="@")
}
if(length(temp4.2)>0){
temp$JWnb[i]<-paste(unlist(temp4.2),sep="@")
}
if(length(temp4.3)>0){
temp$Bnb[i]<-paste(unlist(temp4.3),sep="@")
}
}
# i<-209
# w3110_ftr2[(w3110_ftr2$Start<=temp$Starts[i])&(w3110_ftr2$Start<=temp$Ends[i])&(w3110_ftr2$End>=temp$Starts[i])&(w3110_ftr2$End>=temp$Ends[i]),]
dmulti<-data.frame(Name=multihits,Count=NA,ECKnb=NA,JWnb=NA,Bnb=NA)
i<-1
for(i in 1:nrow(dmulti)){
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$ECKnb)
temp1<-temp1[!is.na(temp1)]
dmulti$Count[i]<-length(temp1)
if(length(temp1)>0){
dmulti$ECKnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$JWnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$JWnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$Bnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$Bnb[i]<-unique(temp1)
}
}
dmulti<-data.frame(Name=multihits,Count=NA,ECKnb=NA,JWnb=NA,Bnb=NA)
i<-1
for(i in 1:nrow(dmulti)){
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$ECKnb)
temp1<-temp1[!is.na(temp1)]
dmulti$Count[i]<-length(temp1)
if(length(temp1)>0){
dmulti$ECKnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$JWnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$JWnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$Bnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$Bnb[i]<-unique(temp1)
}
}
i<-209
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
j<-1
for(j in 1:length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
# print(temp3.1)
if(length(temp3.1)>0){
# print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
temp4.3
unlist(temp4.3)
View(dmulti)
paste(unlist(temp4.3),sep="@")
paste(unlist(temp4.3),collapse="@")
temp<-dprobes[dprobes$Name %in% multihits,]
rownames(temp)<-seq(1,nrow(temp))
temp$ECKnb<-NA
temp$JWnb<-NA
temp$Bnb<-NA
i<-209
for(i in 1:nrow(temp)){
temp1<-as.numeric(unlist(str_split(temp$Starts[i],",")))
temp2<-as.numeric(unlist(str_split(temp$Ends[i],",")))
temp4.1<-list()
temp4.2<-list()
temp4.3<-list()
j<-1
for(j in 1:length(temp1)){
temp3<-w3110_ftr2[(w3110_ftr2$Start<=temp1[j])&(w3110_ftr2$Start<=temp2[j])&(w3110_ftr2$End>=temp1[j])&(w3110_ftr2$End>=temp2[j]),]
temp3.1<-temp3$ECKnb
temp3.1<-temp3.1[!is.na(temp3.1)]
# print(temp3.1)
if(length(temp3.1)>0){
# print(j)
temp4.1[[j]]<-paste(unique(temp3.1),collapse=",")
}
temp3.2<-temp3$JWnb
temp3.2<-temp3.2[!is.na(temp3.2)]
if(length(temp3.2)>0){
print(paste(unique(temp3.2),collapse=","))
temp4.2[[j]]<-paste(unique(temp3.2),collapse=",")
}
temp3.3<-temp3$Bnb
temp3.3<-temp3.3[!is.na(temp3.3)]
if(length(temp3.3)>0){
temp4.3[[j]]<-paste(unique(temp3.3),collapse=",")
}
}
if(length(temp4.1)>0){
temp$ECKnb[i]<-paste(unlist(temp4.1),collapse="@")
}
if(length(temp4.2)>0){
temp$JWnb[i]<-paste(unlist(temp4.2),collapse="@")
}
if(length(temp4.3)>0){
temp$Bnb[i]<-paste(unlist(temp4.3),collapse="@")
}
}
# i<-209
# w3110_ftr2[(w3110_ftr2$Start<=temp$Starts[i])&(w3110_ftr2$Start<=temp$Ends[i])&(w3110_ftr2$End>=temp$Starts[i])&(w3110_ftr2$End>=temp$Ends[i]),]
dmulti<-data.frame(Name=multihits,Count=NA,ECKnb=NA,JWnb=NA,Bnb=NA)
i<-1
for(i in 1:nrow(dmulti)){
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$ECKnb)
temp1<-temp1[!is.na(temp1)]
dmulti$Count[i]<-length(temp1)
if(length(temp1)>0){
dmulti$ECKnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$JWnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$JWnb[i]<-unique(temp1)
}
temp1<-unique(temp[temp$Name==dmulti$Name[i],]$Bnb)
temp1<-temp1[!is.na(temp1)]
if(length(temp1)>0){
dmulti$Bnb[i]<-unique(temp1)
}
}
View(w3110_ftr2)
w3110_ftr$Parent<-str_extract(w3110_ftr$Notes,"Parent=.+;")
View(w3110_ftr)
w3110_ftr$Parent<-str_extract(w3110_ftr$Notes,"Parent=(.*?);/;")
w3110_ftr$Parent<-str_extract(w3110_ftr$Notes,"Parent=(.*?);\;")
w3110_ftr$Parent<-str_extract(w3110_ftr$Notes,"Parent=(.*?);\\;")
w3110_ftr$Parent<-str_extract(w3110_ftr$Notes,"Parent=(.*?);")
w3110_ftr$Parent<-str_remove(str_extract(w3110_ftr$Notes,"Parent=(.*?);"),"Parent=")
w3110_ftr$Parent<-str_remove(str_extract(w3110_ftr$Notes,"Parent=(.*?);"),c("Parent=",","))
w3110_ftr$Parent<-str_remove(str_extract(w3110_ftr$Notes,"Parent=(.*?);"),c("Parent=",";"))
w3110_ftr$Parent<-str_remove(str_extract(w3110_ftr$Notes,"Parent=(.*?);"),"Parent=")
w3110_ftr$Parent<-str_remove(w3110_ftr$Parent,";")
w3110_ftr$ID<-str_remove(str_extract(w3110_ftr$Notes,"ID=(.*?);"),"ID=")
w3110_ftr$ID<-str_remove(w3110_ftr$ID,";")
w3110_ftr$gbkey<-str_remove(str_extract(w3110_ftr$Notes,"gbkey=(.*?);"),"gbkey=")
w3110_ftr$gbkey<-str_remove(w3110_ftr$gbkey,";")
w3110_ftr$gene<-str_remove(str_extract(w3110_ftr$Notes,"gene=(.*?);"),"gene=")
w3110_ftr$gene<-str_remove(w3110_ftr$gene,";")
w3110_ftr2<-w3110_ftr[!is.na(w3110_ftr$ECKJWB),]
rownames(w3110_ftr2)<-seq(1,nrow(w3110_ftr2))
w3110_ftr3<-data.frame(gene=unique(w3110_ftr2$gene),Count.gbkey=NA,Gbkeys=NA)
for(i in 1:nrow(w3110_ftr3)){
temp1<-w3110_ftr2[w3110_ftr2$gene==w3110_ftr3$gene[i],]
w3110_ftr3$Count.gbkey[i]<-nrow(temp1)
w3110_ftr3$Gbkeys[i]<-paste(temp1$gbkey,collapse=",")
}
View(w3110_ftr3)
w3110_ftr3<-data.frame(gene=unique(w3110_ftr2$gene),Count.gbkey=NA,Gbkeys=NA,IDs=NA)
for(i in 1:nrow(w3110_ftr3)){
temp1<-w3110_ftr2[w3110_ftr2$gene==w3110_ftr3$gene[i],]
w3110_ftr3$Count.gbkey[i]<-nrow(temp1)
w3110_ftr3$Gbkeys[i]<-paste(temp1$gbkey,collapse=",")
w3110_ftr3$IDs[i]<-paste(temp1$ID,collapse=",")
}
w3110_ftr3<-data.frame(gene=unique(w3110_ftr2$gene),Count.gbkey=NA,Gbkeys=NA,IDs=NA,ECKnbs=NA,JWnbs=NA,Bnbs=NA)
for(i in 1:nrow(w3110_ftr3)){
temp1<-w3110_ftr2[w3110_ftr2$gene==w3110_ftr3$gene[i],]
w3110_ftr3$Count.gbkey[i]<-nrow(temp1)
w3110_ftr3$Gbkeys[i]<-paste(temp1$gbkey,collapse=",")
w3110_ftr3$IDs[i]<-paste(temp1$ID,collapse=",")
w3110_ftr3$ECKnbs[i]<-paste(unique(temp1$ECKnb),collapse=",")
w3110_ftr3$JWnbs[i]<-paste(unique(temp1$JWnb),collapse=",")
w3110_ftr3$Bnbs[i]<-paste(unique(temp1$Bnb),collapse=",")
}
marray_out<-as.data.frame(read_csv("Data_20211027.csv"))
marray_out<-marray_out[,1]
marray_out<-as.data.frame(read_csv("Data_20211027.csv"))
marray_out<-as.data.frame(marray_out[,1])
View(marray_out)
marray_out<-as.data.frame(read_csv("Data_20211027.csv"))
marray_out<-as.data.frame(ProbeName=marray_out[,1])
marray_out<-data.frame(ProbeName=marray_out[,1])
marray_out<-as.data.frame(read_csv("Data_20211027.csv"))
marray_out<-data.frame(ProbeName=marray_out[,1])
marray_out$Count<-NA
for(i in 1:nrow(marray_out)){
marray_out$Count[i]<-str_count(marray_out$ProbeName,marray_out$ProbeName[i])
}
marray_out<-as.data.frame(read_csv("Data_20211027.csv"))
marray_out<-data.frame(ProbeName=marray_out[,1])
marray_out$Count<-NA
for(i in 1:nrow(marray_out)){
marray_out$Count[i]<-nrow(marray_out[marray_out$ProbeName==marray_out$ProbeName[i],])
}
marray_out.u<-marray_out %>% distinct(ProbeName,.keep_all = T)
marray_out.u
marray_out.u<-left_join(marray_out.u,w3110_ftr3,by=c("ProbeName"="gene"))
View(marray_out.u)
w3110_ftr3[w3110_ftr3$gene %in% marray_out.u[is.na(marray_out.u$IDs),],]
w3110_ftr3[w3110_ftr3$gene %in% marray_out.u[is.na(marray_out.u$IDs),]$ProbeName,]
w3110_ftr3[w3110_ftr3$gene %nin% marray_out.u[!is.na(marray_out.u$IDs),]$ProbeName,]
temp1<-marray_out.u[grepl("-",marray_out.u$ProbeName),]
temp1
temp1<-marray_out.u[grepl("-",marray_out.u$ProbeName)|grepl("_",marray_out.u$ProbeName),]
temp2<-list()
for(i in 1:nrow(temp1)){
temp2[[i]]<-str_split(temp1$ProbeName[i],"-")[[1]]
}
temp2<-unlist(temp2)
temp2
temp2<-list()
for(i in 1:nrow(temp1)){
temp2[[i]]<-str_split(temp1$ProbeName[i],"-")[[1]][1]
}
temp2<-unlist(temp2)
temp2
temp2<-list()
for(i in 1:nrow(temp1)){
temp2[[i]]<-str_split(temp1$ProbeName[i],"-")[[1]][1]
temp2[[i]]<-str_split(temp2[[i]],"_")[[1]][1]
}
temp2<-unlist(temp2)
temp2
temp2<-unique(unlist(temp2))
temp2
marray_out.u.1<-marray_out.u[(is.na(marray_out.u$IDs))&(marray_out.u$ProbeName %in% temp2)&(marray_out.u$Count>1),]
View(marray_out.u.1)
marray_out.u.1<-marray_out.u[(is.na(marray_out.u$IDs))|(marray_out.u$ProbeName %in% temp2)|(marray_out.u$Count>1),]
View(dsingle)
dsingle[dsingle$Name %in% marray_out.u.1,]
dsingle[dsingle$Name %in% marray_out.u.1$ProbeName,]
temp3<-dsingle[dsingle$Name %in% marray_out.u.1$ProbeName,]
temp3<-dsingle[dsingle$Name %in% marray_out.u.1$ProbeName,]
marray_out.u.1$ECKnb<-NA
marray_out.u.1$JWnb<-NA
marray_out.u.1$Bnb<-NA
for(i in 1:nrow(temp3)){
marray_out.u.1[marray_out.u.1$ProbeName==temp3$Name[i],]$ECKnb<-temp3$ECKnb[i]
marray_out.u.1[marray_out.u.1$ProbeName==temp3$Name[i],]$JWnb<-temp3$JWnb[i]
marray_out.u.1[marray_out.u.1$ProbeName==temp3$Name[i],]$Bnb<-temp3$Bnb[i]
}
View(dmulti)
View(dnaseq.c)
View(dprobes)
temp<-dprobes[dprobes$Name %in% marray_out.u.1$ProbeName,]
View(temp)
View(marray_out)
View(dmulti)
save.image("./MicroarrayProbe.RData")
load("./MicroarrayProbe.RData")
library(viridis)
library(ggplot2)
library(GGally)
library(scales)
library(ggpubr)
library(grid)
library(gtable)
library(gridExtra)
library(dplyr)
library(matrixStats)
library(preprocessCore)
library(RColorBrewer)
library(openxlsx)
library(ggsci)
library(cowplot)
library(corrplot)
library(Hmisc)
# https://stackoverflow.com/questions/59419647/hmisc-package-or-namespace-failed-to-load-no-package-called-latticeextra
library(corrplot)
library(tidyverse)
library(magrittr)
library(dendextend)
library(FactoMineR)
library(factoextra)
library(proxy)
library(rstatix)
# library(plot3D)
library(clusterProfiler)
library(pathview)
library(org.EcK12.eg.db)
library(rvest)
library(corrr)
library(GOSemSim)
library(rrvgo)
library(qdapTools)
library(AnnotationDbi)
library(ggVennDiagram)
library(rJava)
library(venneuler)
library(igraph)
library(tidygraph)
library(recoRdseq) # for Record-seq
library(patchwork) # for Record-seq
library(Biostrings)
# library(BSgenome)
# library(BSgenome.Ecoli.NCBI.20080805)
# library(biomaRt)
# library(biomartr)
View(marray_out.u.1)
cure3<-as.data.frame(read_csv("Cure_3.csv"))
View(cure3)
marray_out.u.2<-marray_out.u[marray_out.u$ProbeName %nin% marray_out.u.1$ProbeName,]
temp<-marray_out.u.1
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs))]
temp<-left_join(temp,cure3[,which(colnames(cure3) %in% qw(ProbeName,ECKnb,JWnb,Bnb))],by="ProbeName")
View(temp)
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs))]
View(marray_out.u.2)
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs,ECKnb,JWnb,Bnb))]
temp<-left_join(temp,cure3[,which(colnames(cure3) %in% qw(ProbeName,ECKnb,JWnb,Bnb))],by="ProbeName")
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs,ECKnb,JWnb,Bnb))]
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs,ECKnb,JWnb,Bnb))]
temp<-left_join(temp,cure3[,which(colnames(cure3) %in% qw(ProbeName,ECKnb,JWnb,Bnb))],by="ProbeName")
marray_out.u.2<-rbind(marray_out.u.2,temp)
colnames(temp)
colnames(temp)[colnames(temp)=="ECKnb"]
colnames(temp)[colnames(temp)=="ECKnb"]<-"ECKnbs"
colnames(temp)[colnames(temp)=="JWnb"]<-"JWnbs"
colnames(temp)[colnames(temp)=="Bnb"]<-"Bnbs"
marray_out.u.2<-rbind(marray_out.u.2,temp)
marray_out.u.2<-marray_out.u[marray_out.u$ProbeName %nin% marray_out.u.1$ProbeName,]
temp<-marray_out.u.1[,which(colnames(marray_out.u.1) %nin% qw(ECKnbs,JWnbs,Bnbs,ECKnb,JWnb,Bnb))]
temp<-left_join(temp,cure3[,which(colnames(cure3) %in% qw(ProbeName,ECKnb,JWnb,Bnb))],by="ProbeName")
colnames(temp)[colnames(temp)=="ECKnb"]<-"ECKnbs"
colnames(temp)[colnames(temp)=="JWnb"]<-"JWnbs"
colnames(temp)[colnames(temp)=="Bnb"]<-"Bnbs"
marray_out.u.2<-bind_rows(marray_out.u.2,temp)
temp<-marray_out.u.2[!is.na(marray_out.u.2$ECKnbs),]
length(unique(temp$ECKnbs))
View(w3110_ftr3)
View(w3110_ftr2)
marray_out.u.2[grepl("^ins",marray_out.u.2$ProbeName),]
temp<-marray_out.u.2[grepl("^ins",marray_out.u.2$ProbeName),]
temp<-marray_out.u.2[grepl("^ins",marray_out.u.2$ProbeName)|grepl("IS[0-9]{3}",marray_out.u.2$ProbeName),]
marray_out.u.2$IStag<-F
marray_out.u.2[grepl("^ins",marray_out.u.2$ProbeName)|grepl("IS[0-9]{3}",marray_out.u.2$ProbeName),]$IStag<-T
write.csv(marray_out.u.2,"Probe2IDs.csv")
